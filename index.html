<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Legge di Bilancio 2026 - Studio BDZ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'studio-navy': '#0c2340',
            'studio-blue': '#2c5282',
          },
          fontFamily: {
            sans: ['-apple-system', 'BlinkMacSystemFont', 'San Francisco', 'Helvetica Neue', 'Arial', 'sans-serif'],
            serif: ['Charter', 'Georgia', 'serif']
          }
        }
      }
    }
  </script>
</head>

<body>
  <div id="root"></div>

  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <script type="text/babel">
    const { useState, useRef, useEffect } = React;

    // === KNOWLEDGE BASE COMPLETO STUDIO BDZ ===
    const KNOWLEDGE_BASE = {
      sections: [
        {
          title: "1. IRPEF e Imposte Personali",
          icon: "ðŸ’°",
          content: `**Riduzione aliquota IRPEF secondo scaglione**
La legge di bilancio 2026 prevede la riduzione dal 35% al 33% dell'aliquota IRPEF del secondo scaglione (redditi 28.000-50.000â‚¬).

Nuova struttura aliquote IRPEF:
- 23% per redditi fino a 28.000â‚¬
- 33% (prima 35%) per redditi da 28.000â‚¬ a 50.000â‚¬
- 43% per redditi oltre 50.000â‚¬

Risparmio fiscale: Massimo 440â‚¬ annui
Decorrenza: Dal periodo d'imposta 2026

**Riduzione detrazioni per redditi oltre 200.000â‚¬**
Per neutralizzare il risparmio dalla riduzione dell'aliquota IRPEF, dal 2026 chi ha reddito superiore a 200.000â‚¬ subisce una riduzione di 440â‚¬ sulle detrazioni IRPEF.

Oneri interessati dalla riduzione:
- Oneri detraibili al 19% (escluse spese sanitarie)
- Erogazioni liberali a partiti politici (26%)
- Premi assicurazione eventi calamitosi (90%)

Oneri NON interessati:
- Detrazioni per familiari a carico
- Recupero edilizio, ecobonus, sismabonus`
        },
        {
          title: "2. Bonus Casa e Immobili",
          icon: "ðŸ ",
          content: `**Bonus casa - Proroga aliquote 2026**
Prorogate per il 2026 le aliquote bonus casa:

Aliquota maggiorata 50%:
- Abitazione principale
- Spese 1.1.2025 - 31.12.2026
- Limite: 96.000â‚¬
- Nel 2027 scende al 36%

Aliquota ordinaria 36%:
- Altri immobili
- Spese 1.1.2025 - 31.12.2026
- Limite: 96.000â‚¬
- Nel 2027 scende al 30%

**Ecobonus e Sismabonus 2026**
Le aliquote ecobonus e sismabonus sono allineate al bonus casa:

Per abitazioni principali:
- 50% per spese 2025-2026
- 36% per spese 2027

Per altri immobili:
- 36% per spese 2025-2026
- 30% per spese 2027

**Bonus mobili - Proroga 2026**
Prorogata per il 2026 la detrazione IRPEF 50% per acquisto mobili e grandi elettrodomestici.

Requisiti:
- Spese sostenute 1.1.2026 - 31.12.2026
- Interventi recupero edilizio dall'1.1.2025
- Limite massimo: 5.000â‚¬

**Locazioni brevi - Presunzione imprenditorialitÃ **
STRETTA sulle locazioni brevi dal 2026:

Soglia abbassata:
- Prima: max 4 appartamenti
- Dal 2026: max 2 appartamenti
- Da 3 appartamenti: obbligo P.IVA

Aliquote cedolare secca 2026:
- 1 appartamento: 21%
- 2 appartamenti: uno al 21%, altro al 26%
- 3+ appartamenti: fuori cedolare`
        },
        {
          title: "3. Lavoro e Welfare",
          icon: "ðŸ‘”",
          content: `**Detassazione premi di risultato**
Riduzione significativa imposta sostitutiva premi:

Aliquote:
- 2026-2027: 1% (prima 5%)
- Limite: 5.000â‚¬ (prima 3.000â‚¬)

Beneficiari:
- Dipendenti settore privato
- Incrementi produttivitÃ , redditivitÃ , qualitÃ 

**Imposta sostitutiva incrementi contrattuali**
Nuova imposta sostitutiva solo per 2026:

Caratteristiche:
- Aliquota: 5%
- Solo anno 2026
- Aumenti da contratti rinnovati 1.1.2024 - 31.12.2026
- Solo dipendenti settore privato

Condizioni:
- Reddito 2025 â‰¤ 33.000â‚¬
- FacoltÃ  di rinuncia da parte lavoratore

**Imposta sostitutiva trattamento accessorio**
Imposta sostitutiva 15% sul trattamento accessorio (solo 2026):

Somme agevolate:
- Maggiorazioni lavoro notturno
- Maggiorazioni lavoro festivi
- IndennitÃ  di turno

Requisiti:
- Reddito 2025 â‰¤ 40.000â‚¬
- Limite annuo: 1.500â‚¬

**Bonus Mamme**
Somma di 60â‚¬ mensili per lavoratrici con:
- Almeno 2 figli (fino a 10 anni del figlio piÃ¹ piccolo)
- Oppure 3 figli (fino a 18 anni del figlio piÃ¹ piccolo)

**Incentivo Assunzioni**
Esonero contributivo 100% (max 8.000â‚¬/anno) per:
- Mamme con 3 figli
- Giovani/donne svantaggiate

**Buoni pasto elettronici**
Incremento soglia esenzione:
- Buoni elettronici: 10â‚¬ (prima 8â‚¬)
- Buoni cartacei: 4â‚¬ (invariata)

**Previdenza complementare**
Nuovo limite deducibilitÃ : 5.300â‚¬ annui (prima 5.164,57â‚¬)`
        },
        {
          title: "4. Imprese e Investimenti",
          icon: "ðŸ­",
          content: `**Iper-ammortamenti 4.0 e 5.0**
Nuovi iper-ammortamenti per periodo 1.1.2026 - 30.9.2028:

Beni agevolati:
- Materiali e immateriali 4.0
- Autoproduzione energia rinnovabile
- Prodotti UE/SEE

Maggiorazioni:
- 180% fino a 2,5 milioni â‚¬
- 100% da 2,5 a 10 milioni â‚¬
- 50% da 10 a 20 milioni â‚¬

Accesso: Comunicazione GSE

**Credito imposta energivore**
Credito d'imposta per imprese energivore:

Investimenti:
- Beni materiali e immateriali tipo A e B
- Effettuati nel 2025

Aliquote:
- 35% fino a 10 milioni â‚¬
- 5% da 10 a 50 milioni â‚¬
- Fino al 45% con riduzioni significative consumi

**Nuova Sabatini**
Incremento autorizzazione:
- 200 milioni â‚¬ anno 2026
- 450 milioni â‚¬ anno 2027

FinalitÃ :
- Finanziamenti agevolati PMI
- Acquisto beni strumentali
- Leasing finanziario

**Modifiche dividendi e plusvalenze**
Nuove condizioni esclusione parziale (dal 2026):
- Partecipazione â‰¥ 5% capitale
- OPPURE valore fiscale â‰¥ 500.000â‚¬

Se requisiti NON rispettati: integralmente imponibili

**Frazionamento plusvalenze - Eliminazione**
Dal 2026 eliminata rateizzazione plusvalenze:
- Tassate per intero anno realizzo
- Eccezione: cessioni azienda/rami (max 5 anni, possesso â‰¥ 3 anni)

**Assegnazione agevolata beni ai soci**
Riproposta assegnazione agevolata (termine: 30.9.2026):

Imposte sostitutive:
- 8% su plusvalenze (10,5% societÃ  comodo)
- 13% su riserve sospensione imposta

**Regime forfetario**
Confermato limite reddito dipendente:
- Soglia 2026: 35.000â‚¬
- Se redditi 2025 > 35.000â‚¬: no forfetario 2026`
        },
        {
          title: "5. Riscossione e Adempimenti",
          icon: "âš–ï¸",
          content: `**Rottamazione-quinquies**
Nuova rottamazione (quinta edizione):

Carichi rottamabili:
- Consegnati 1.1.2000 - 31.12.2023
- Omessi versamenti dichiarati
- Contributi INPS dichiarati
- Violazioni Codice strada (solo interessi)

Benefici:
- Stralcio sanzioni
- Stralcio interessi mora
- Stralcio compensi riscossione

Domanda: Entro 30.4.2026

Pagamento:
- Unica soluzione entro 31.7.2026
- Oppure max 54 rate (2026-2035)
- Rate bimestrali con interessi 3%

**Blocco pagamenti PA per professionisti**
Stretta blocco pagamenti:

Nuova disciplina professionisti:
- Verifica OGNI pagamento (senza soglia)
- Blocco per OGNI carico (anche 100â‚¬)

Procedura:
- PA richiede verifica AdER
- Se carichi: blocco e pignoramento

Decorrenza: Pagamenti da 15.6.2026

**Divieto compensazione con ruoli scaduti**
Stretta divieto compensazione:

Nuova soglia: 50.000â‚¬ (prima 100.000â‚¬)

Divieto:
- Compensazione crediti fiscali vietata
- Se debiti iscritti a ruolo > 50.000â‚¬

Eccezioni:
- Dilazione in essere e in regola
- Domanda rottamazione presentata

**Ritenuta transazioni B2B (dal 2028)**
Nuova ritenuta pagamenti B2B:

Aliquote:
- 2028: 0,5%
- Dal 2029: 1%
- A titolo acconto imposte redditi

Ambito:
- Prestazioni servizi tra imprese
- Cessioni beni tra imprese
- NO operazioni verso consumatori`
        },
        {
          title: "6. Altre NovitÃ  Fiscali",
          icon: "ðŸ“Š",
          content: `**Rideterminazione costo fiscale partecipazioni**
Aumento aliquota affrancamento:
- Imposta sostitutiva: 21% (prima 18%)
- Solo per partecipazioni
- Terreni: resta 18%

Decorrenza: Rivalutazioni all'1.1.2026

**Criptovalute - Stablecoins euro**
Regime speciale stablecoins euro:

Aliquota agevolata:
- 26% invece del 33%
- Solo token moneta elettronica euro

Requisiti:
- Valore ancorato a euro
- Fondi riserva 100% in attivitÃ  euro

**Dichiarazione IVA omessa**
Nuova procedura liquidazione IVA omessa:

Fonte dati:
- Fatturazione elettronica
- Corrispettivi telematici
- LIPE

Procedura:
- Comunicazione bonaria Agenzia Entrate
- Sanzione 120% (40% se paghi entro 60 gg)

**Uso contanti turisti esteri**
Innalzamento soglia comunicazione:
- Nuova soglia: 5.000â‚¬ (prima 1.000â‚¬)

**Imposta premi RCA**
Aumento imposta premi assicurazione:
- Nuova aliquota: 12,5% (dal 2026)
- Infortunio conducente e assistenza stradale

**Tobin Tax**
Aliquote raddoppiate:
- 0,2% per mercati regolamentati (prima 0,1%)
- 0,4% non regolamentati (prima 0,2%)

**Imposta di soggiorno**
Comuni possono aumentare:
- Fino a +2â‚¬ per notte
- Anno 2026

**Plastic tax e sugar tax**
Ulteriore differimento:
- Decorrenza: 1.1.2027 (rinvio)`
        },
        {
          title: "7. Altre Misure",
          icon: "ðŸ“š",
          content: `**Contributi libri scolastici**
Nuovi contributi per famiglie studenti:

Libri scolastici:
- Fondo 20 milioni â‚¬/anno dal 2026
- Acquisto libri anche digitali
- Scuola secondaria secondo grado
- ISEE â‰¤ 30.000â‚¬

Scuole paritarie:
- Contributo fino a 1.500â‚¬/studente 2026
- Scuola paritaria secondaria primo grado
- Primo biennio secondo grado
- ISEE â‰¤ 30.000â‚¬
- Dotazione: 20 milioni â‚¬ 2026`
        }
      ],

      faqs: [
        {
          question: "Quanto risparmio con la nuova IRPEF?",
          answer: "La riduzione dell'aliquota IRPEF dal 35% al 33% per il secondo scaglione (redditi 28.000-50.000â‚¬) comporta un risparmio fiscale massimo di 440â‚¬ annui. Il risparmio effettivo dipende dal tuo reddito: Ã¨ massimo per redditi pari o superiori a 50.000â‚¬, proporzionalmente minore per redditi inferiori."
        },
        {
          question: "Quanti appartamenti posso affittare con Airbnb senza partita IVA?",
          answer: "Dal 2026 la soglia si abbassa drasticamente: puoi affittare massimo 2 appartamenti con contratti di locazione breve mantenendo la cedolare secca. Da 3 appartamenti in su scatta la presunzione di imprenditorialitÃ  con obbligo di apertura partita IVA. Per 1 appartamento applichi cedolare 21%, per 2 appartamenti uno al 21% e l'altro al 26%."
        },
        {
          question: "Cosa cambia per le detrazioni del bonus casa?",
          answer: "Per il 2026 le aliquote bonus casa sono prorogate: 50% per interventi sull'abitazione principale (limite 96.000â‚¬) e 36% per altri immobili (limite 96.000â‚¬). Dal 2027 le aliquote scenderanno rispettivamente al 36% e al 30%. Il bonus mobili Ã¨ prorogato con limite di 5.000â‚¬."
        },
        {
          question: "Posso aderire alla rottamazione se sono decaduto dalle precedenti?",
          answer: "SÃ¬, puoi aderire alla rottamazione-quinquies anche se sei decaduto da precedenti rottamazioni (ter o quater), purchÃ© si tratti di carichi rientranti nella nuova definizione. PerÃ² attenzione: se al 30.9.2025 risultavi in regola con le rate della precedente rottamazione, devi continuare a pagarle e NON puoi accedere alla nuova."
        },
        {
          question: "I premi di risultato sono ancora agevolati?",
          answer: "SÃ¬, anzi migliorati! Per il 2026 e 2027 l'imposta sostitutiva scende dall'attuale 5% all'1% e il limite sale da 3.000â‚¬ a 5.000â‚¬. Si applica su premi di risultato e partecipazione agli utili per dipendenti del settore privato collegati a incrementi di produttivitÃ ."
        }
      ]
    };

    // === NETLIFY FUNCTION CLIENT ===
    // La chat deve chiamare SOLO la Function (API key e modello stanno lato server).
    async function callChatFunction(userMessage, history) {
      try {
        const payload = {
          message: userMessage,
          // Manteniamo uno storico leggero (ultimi 10 messaggi) per contesto, se la function lo gestisce
          history: (history || []).slice(-10).map(m => ({
            role: m.role === 'user' ? 'user' : 'assistant',
            text: m.text
          }))
        };

        const res = await fetch('https://bilancio-2026-bdz-chat.fabio-zambelli1973.workers.dev' /* TODO: Sostituisci TUOACCOUNT con il tuo account Cloudflare */, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });

        // Se la function risponde con JSON, lo leggiamo sempre
        const data = await res.json().catch(() => ({}));

        if (!res.ok) {
          // Errore â€œlato functionâ€
          return data?.response
            || "Spiacente, si Ã¨ verificato un errore nella connessione. La preghiamo di riprovare piÃ¹ tardi o contattare lo Studio allo +39 045 577694.";
        }

        return data?.response
          || "Spiacente, risposta non valida dal server. La preghiamo di contattare lo Studio allo +39 045 577694.";
      } catch (e) {
        return "Spiacente, si Ã¨ verificato un errore nella connessione. La preghiamo di riprovare piÃ¹ tardi o contattare lo Studio allo +39 045 577694.";
      }
    }

    // === REACT APP ===
    function App() {
      const [openSection, setOpenSection] = useState(0);
      const [isChatOpen, setIsChatOpen] = useState(false);
      const [messages, setMessages] = useState([]);
      const [inputValue, setInputValue] = useState("");
      const [isTyping, setIsTyping] = useState(false);
      const scrollRef = useRef(null);

      useEffect(() => {
        if (scrollRef.current) {
          scrollRef.current.scrollTop = scrollRef.current.scrollHeight;
        }
      }, [messages, isTyping]);

      const handleSendMessage = async () => {
        if (!inputValue.trim() || isTyping) return;

        const userMsg = inputValue.trim();
        const nextHistory = [...messages, { role: 'user', text: userMsg }];

        setMessages(nextHistory);
        setInputValue("");
        setIsTyping(true);

        // Chiamata alla Netlify Function (non piÃ¹ Gemini dal browser)
        const result = await callChatFunction(userMsg, messages);

        setMessages(prev => [...prev, { role: 'assistant', text: result }]);
        setIsTyping(false);
      };

      return (
        <div className="min-h-screen bg-gray-50 text-gray-900 flex flex-col font-sans">
          {/* Header Studio */}
          <header className="bg-white border-b border-gray-200 py-10 px-8 sticky top-0 z-40 shadow-sm">
            <div className="max-w-4xl mx-auto flex flex-col md:flex-row justify-between items-center text-center md:text-left gap-6">
              <div>
                <h1 className="text-4xl font-light tracking-tight text-gray-900">
                  Studio <span className="font-bold text-studio-navy">BDZ</span>
                </h1>
                <p className="text-xs uppercase tracking-widest text-gray-400 font-semibold mt-2">
                  Basso â€¢ De Bortoli â€¢ Zambelli
                </p>
              </div>
              <div className="md:text-right md:border-l md:border-gray-200 md:pl-10">
                <h2 className="text-sm font-semibold text-gray-600 uppercase tracking-wide">Legge di Bilancio 2026</h2>
                <p className="text-xs text-gray-400 mt-1">Circolare per la Clientela n. 01/2026</p>
              </div>
            </div>
          </header>

          {/* Main Content */}
          <main className="flex-1 w-full max-w-4xl mx-auto px-6 py-16 space-y-6">
            <div className="mb-12 text-center">
              <span className="bg-blue-50 text-studio-navy text-xs font-bold px-4 py-2 rounded-full uppercase tracking-wider">Consultazione Documentale</span>
              <h2 className="text-3xl font-bold text-gray-800 mt-6 mb-3">Principali NovitÃ  Normative</h2>
              <div className="w-16 h-1 bg-studio-navy mx-auto rounded-full"></div>
            </div>

            <div className="space-y-4">
              {KNOWLEDGE_BASE.sections.map((section, idx) => (
                <div key={idx} className="group bg-white border border-gray-200 rounded-2xl overflow-hidden transition-all duration-300 hover:shadow-xl hover:border-blue-200">
                  <button
                    onClick={() => setOpenSection(openSection === idx ? null : idx)}
                    className="w-full flex items-center justify-between p-7 text-left outline-none"
                  >
                    <div className="flex items-center gap-4">
                      <span className="text-3xl">{section.icon}</span>
                      <span className={`text-lg font-semibold tracking-tight transition-colors ${openSection === idx ? 'text-studio-navy' : 'text-gray-600 group-hover:text-gray-900'}`}>
                        {section.title}
                      </span>
                    </div>
                    <svg
                      className={`w-5 h-5 transition-transform duration-500 ${openSection === idx ? 'rotate-180 text-studio-navy' : 'text-gray-300'}`}
                      fill="none" stroke="currentColor" viewBox="0 0 24 24"
                    >
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2.5" d="M19 9l-7 7-7-7" />
                    </svg>
                  </button>

                  <div className={`transition-all duration-500 ease-in-out ${openSection === idx ? 'max-h-[1000px] opacity-100' : 'max-h-0 opacity-0'} overflow-hidden`}>
                    <div className="px-7 pb-8 pt-2 text-gray-600 leading-relaxed text-base font-serif whitespace-pre-line border-t border-gray-100">
                      {section.content}
                    </div>
                  </div>
                </div>
              ))}
            </div>

            {/* FAQ Section */}
            <div className="mt-16">
              <h3 className="text-2xl font-bold text-gray-800 mb-6">ðŸ’¬ Domande Frequenti</h3>
              <div className="space-y-4">
                {KNOWLEDGE_BASE.faqs.map((faq, idx) => (
                  <details key={idx} className="bg-white rounded-xl shadow-sm p-6 border border-gray-200">
                    <summary className="font-semibold text-studio-navy cursor-pointer hover:text-studio-blue">
                      {faq.question}
                    </summary>
                    <div className="mt-4 text-gray-600 leading-relaxed text-sm">
                      {faq.answer}
                    </div>
                  </details>
                ))}
              </div>
            </div>

            <div className="mt-20 text-center border-t border-gray-200 pt-10">
              <p className="text-xs text-gray-400 uppercase tracking-widest">Studio BDZ Associati | Verona | 2026</p>
            </div>
          </main>

          {/* Chat Button */}
          <div className="fixed bottom-10 right-10 z-50">
            {!isChatOpen ? (
              <button
                onClick={() => setIsChatOpen(true)}
                className="group flex items-center gap-4 bg-studio-navy text-white pl-6 pr-5 py-5 rounded-full shadow-2xl hover:shadow-[0_25px_50px_-12px_rgba(12,35,64,0.5)] transition-all transform hover:-translate-y-1 active:scale-95"
              >
                <div className="flex flex-col items-start leading-none">
                  <span className="text-xs font-bold uppercase tracking-widest text-blue-300 mb-1">Assistente AI</span>
                  <span className="font-bold text-sm">Richiedi Info</span>
                </div>
                <div className="bg-white/10 p-2 rounded-full backdrop-blur-md group-hover:bg-white/20 transition-colors">
                  <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z" />
                  </svg>
                </div>
              </button>
            ) : (
              <div className="w-[380px] md:w-[450px] h-[600px] bg-white rounded-3xl shadow-2xl flex flex-col border border-gray-200 overflow-hidden">
                {/* Chat Header */}
                <div className="bg-studio-navy p-6 text-white flex justify-between items-center shadow-lg">
                  <div className="flex items-center gap-3">
                    <div className="relative">
                      <div className="w-10 h-10 bg-blue-500/20 rounded-xl flex items-center justify-center border border-white/10">
                        <svg className="w-6 h-6 text-blue-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M13 10V3L4 14h7v7l9-11h-7z" /></svg>
                      </div>
                      <div className="absolute -bottom-1 -right-1 w-3 h-3 bg-green-500 rounded-full border-2 border-studio-navy"></div>
                    </div>
                    <div>
                      <h3 className="text-sm font-bold tracking-wide">Expert Advisor BDZ</h3>
                      <p className="text-xs text-blue-300 uppercase tracking-wider opacity-80">Powered by Gemini</p>
                    </div>
                  </div>
                  <button onClick={() => setIsChatOpen(false)} className="hover:bg-white/10 p-2 rounded-full transition-colors">
                    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2.5" d="M6 18L18 6M6 6l12 12" /></svg>
                  </button>
                </div>

                {/* Chat Messages */}
                <div ref={scrollRef} className="flex-1 overflow-y-auto p-6 space-y-6 bg-gray-50">
                  {messages.length === 0 && (
                    <div className="text-center py-10 space-y-4">
                      <div className="w-16 h-16 bg-blue-50 rounded-3xl flex items-center justify-center mx-auto text-blue-900 border border-blue-100">
                        <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" /></svg>
                      </div>
                      <h4 className="font-bold text-gray-800 text-sm">Come posso assisterLa oggi?</h4>
                      <p className="text-xs text-gray-500 px-10 leading-relaxed">AnalizzerÃ² la Circolare di Bilancio 2026 per fornirLe risposte precise e professionali.</p>
                    </div>
                  )}

                  {messages.map((m, i) => (
                    <div key={i} className={`flex ${m.role === 'user' ? 'justify-end' : 'justify-start'}`}>
                      <div className={`max-w-[85%] rounded-2xl px-5 py-4 text-sm leading-relaxed shadow-sm ${
                        m.role === 'user'
                          ? 'bg-studio-navy text-white rounded-tr-none'
                          : 'bg-white text-gray-700 border border-gray-200 rounded-tl-none'
                      }`}>
                        {m.text}
                      </div>
                    </div>
                  ))}

                  {isTyping && (
                    <div className="flex justify-start">
                      <div className="bg-white border border-gray-200 rounded-2xl rounded-tl-none px-5 py-4 flex gap-2 shadow-sm">
                        <span className="w-2 h-2 bg-blue-300 rounded-full animate-bounce"></span>
                        <span className="w-2 h-2 bg-blue-400 rounded-full animate-bounce" style={{animationDelay: '0.15s'}}></span>
                        <span className="w-2 h-2 bg-blue-500 rounded-full animate-bounce" style={{animationDelay: '0.3s'}}></span>
                      </div>
                    </div>
                  )}
                </div>

                {/* Chat Input */}
                <div className="p-6 border-t border-gray-200 bg-white">
                  <div className="relative">
                    <input
                      type="text"
                      value={inputValue}
                      onChange={(e) => setInputValue(e.target.value)}
                      onKeyDown={(e) => e.key === 'Enter' && handleSendMessage()}
                      placeholder="Scriva qui la sua domanda..."
                      className="w-full bg-gray-50 border border-gray-200 rounded-2xl px-5 py-4 text-sm focus:ring-2 focus:ring-studio-navy/20 focus:outline-none transition-all pr-14"
                    />
                    <button
                      onClick={handleSendMessage}
                      disabled={!inputValue.trim() || isTyping}
                      className="absolute right-2 top-2 bg-studio-navy text-white w-10 h-10 rounded-xl flex items-center justify-center hover:bg-blue-900 transition-colors disabled:opacity-20 shadow-md"
                    >
                      <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2.5" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" /></svg>
                    </button>
                  </div>
                  <p className="text-xs text-gray-400 text-center mt-4 uppercase tracking-wider opacity-60">Consulenza Digitalizzata Studio BDZ</p>
                </div>
              </div>
            )}
          </div>
        </div>
      );
    }

    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>
